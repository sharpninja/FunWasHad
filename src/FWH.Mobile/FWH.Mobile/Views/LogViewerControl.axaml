<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:FWH.Mobile.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="250"
             x:Class="FWH.Mobile.Views.LogViewerControl"
             x:DataType="vm:LogViewerViewModel">

    <DockPanel>
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,6">
            <Button Content="✕"
                    Command="{Binding ClearCommand}"
                    ToolTip.Tip="Clear logs"
                    HorizontalAlignment="Left"
                    Margin="0,0,6,0"
                    Width="32"
                    Height="32" />

            <Button Content="{Binding PauseButtonText}"
                    Command="{Binding TogglePauseCommand}"
                    ToolTip.Tip="{Binding PauseButtonToolTip}"
                    HorizontalAlignment="Left"
                    Margin="0,0,6,0"
                    Width="32"
                    Height="32" />

            <ComboBox ItemsSource="{Binding LogLevels}"
                      SelectedItem="{Binding SelectedLogLevel}"
                      MinWidth="120"
                      Margin="0,0,6,0" />

            <Button Content="⬇"
                    Command="{Binding ScrollToEndCommand}"
                    ToolTip.Tip="Scroll to end"
                    HorizontalAlignment="Left"
                    Width="32"
                    Height="32" />
        </StackPanel>

        <Border BorderBrush="#3A3A3A" BorderThickness="1" CornerRadius="4" Padding="6">
            <ScrollViewer x:Name="LogScrollViewer">
                <ItemsControl ItemsSource="{Binding FilteredEntries}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Background="{Binding LevelBackgroundColor}"
                                    Padding="4,2"
                                    Margin="0,0,0,1">
                                <TextBlock FontFamily="Consolas" FontSize="12" TextWrapping="Wrap" Foreground="#FFFFFF">
                                    <Run Text="[" Foreground="#888888" />
                                    <Run Text="{Binding Id}" Foreground="#AAAAAA" />
                                    <Run Text="]" Foreground="#888888" />
                                    <Run Text=" " />
                                    <Run Text="{Binding TimestampUtc}" Foreground="#CCCCCC" />
                                    <Run Text=" " />
                                    <Run Text="{Binding LevelShort}" FontWeight="Bold" />
                                    <Run Text=" " />
                                    <Run Text="{Binding Category}" Foreground="#DDDDDD" />
                                    <Run Text=": " />
                                    <Run Text="{Binding Message}" />
                                </TextBlock>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Border>
    </DockPanel>
</UserControl>
